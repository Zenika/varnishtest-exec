<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at Jun 29, 2013
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20130629" />
    <meta http-equiv="Content-Language" content="en" />
    <title></title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script>

    
            </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>varnishtest-exec</h2>
                </div>
                      </div>
        <div class="pull-right">                  <a href="http://www.varnish-cache.org/" id="bannerRight" title="Varnish Cache">
                                                                                                <img src="img/varnish_stamp.png"  alt="Varnish Cache"/>
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
            
                  <li id="projectVersion">Version: 0.2</li>
              
                
            
                  <li id="publishDate" class="pull-right">Last Published: 2013-06-29</li> 
            
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
            
                <ul class="nav nav-list">
                    <li class="nav-header">Overview</li>
                                
      <li>
    
                          <a href="index.html" title="Introduction">
          <i class="none"></i>
        Introduction</a>
            </li>
                  
      <li class="active">
    
            <a href="#"><i class="none"></i>Ant Task</a>
          </li>
                  
      <li>
    
                          <a href="maven-plugin.html" title="Maven Plugin">
          <i class="none"></i>
        Maven Plugin</a>
            </li>
                  
      <li>
    
                          <a href="changelog.html" title="Changelog">
          <i class="none"></i>
        Changelog</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                      
      <li>
    
                          <a href="project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
                                                                                                                                            
      <li>
    
                          <a href="project-reports.html" title="Project Reports">
          <i class="icon-chevron-right"></i>
        Project Reports</a>
                  </li>
                              <li class="nav-header">Zenika</li>
                                
      <li>
    
                          <a href="http://www.zenika.com/" class="externalLink" title="Home">
          <i class="none"></i>
        Home</a>
            </li>
                  
      <li>
    
                          <a href="http://blog.zenika.com/" class="externalLink" title="Blog">
          <i class="none"></i>
        Blog</a>
            </li>
                  
      <li>
    
                          <a href="http://github.com/Zenika" class="externalLink" title="Github">
          <i class="none"></i>
        Github</a>
            </li>
                  
      <li>
    
                          <a href="http://twitter.com/ZenikaIT" class="externalLink" title="Twitter">
          <i class="none"></i>
        Twitter</a>
            </li>
                  
      <li>
    
                          <a href="http://plus.google.com/108892729147754063840/posts" class="externalLink" title="Google+">
          <i class="none"></i>
        Google+</a>
            </li>
            </ul>
                
            
                
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                                                                                                                         <a href="http://www.zenika.com/" title="Built by Maven" class="builtBy">
        <img class="builtBy"  alt="Zenika" src="img/logo-zenika.jpg"    />
      </a>
                      </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <!-- Copyright 2013 Zenika --><!--  --><!-- Licensed under the Apache License, Version 2.0 (the "License"); --><!-- you may not use this file except in compliance with the License. --><!-- You may obtain a copy of the License at --><!--  --><!-- http://www.apache.org/licenses/LICENSE-2.0 --><!--  --><!-- Unless required by applicable law or agreed to in writing, software --><!-- distributed under the License is distributed on an "AS IS" BASIS, --><!-- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. --><!-- See the License for the specific language governing permissions and --><!-- limitations under the License. --><div class="section"><h2>Varnishtest Ant Task<a name="Varnishtest_Ant_Task"></a></h2></div><div class="section"><h2>Description<a name="Description"></a></h2><p>This task runs tests from the Varnish testing framework. This framework is bundled with Varnish on major distributions, and actually uses Varnish under the hood. The first requirement is to have Varnish installed somewhere on your system. This task works with Ant 1.7.0 or any later version.</p><p>You can download <tt>varnishtest-exec</tt> from the Maven central:</p><ul><li><a class="externalLink" href="http://search.maven.org/remotecontent?filepath=com/zenika/varnishtest-exec/0.2/varnishtest-exec-0.2.jar">varnishtest-exec-0.2</a></li><li><a class="externalLink" href="http://search.maven.org/remotecontent?filepath=org/apache/commons/commons-exec/1.1/commons-exec-1.1.jar">commons-exec-1.1.jar</a></li></ul><p><b>Note:</b> You must have <tt>varnishtest-exec</tt> available. You can do one of:</p><ul><li>Put both <tt>varnishtest-exec-0.2.jar</tt> and <tt>commons-exec-1.1.jar</tt> in <tt>ANT_HOME/lib</tt>.</li><li>Do not put either in <tt>ANT_HOME/lib</tt>, and instead include their locations in your <tt>CLASSPATH</tt> environment variable.</li><li>Add both JARs to your classpath using <tt>-lib</tt>.</li><li>Specify the locations of both JARs using a <tt>&lt;classpath&gt;</tt> element in a <tt>&lt;taskdef&gt;</tt> in the build file. The JARs can be first retrieved using <a class="externalLink" href="http://ant.apache.org/ivy/">Ivy</a>.</li></ul><p>If you put <tt>varnishtest-exec</tt> in your Ant <i>classpath</i>, you can use it this way:</p><div class="source"><pre class="prettyprint">&lt;project xmlns:varnishtest=&quot;antlib:com.zenika.varnishtest.ant&quot;&gt;
    &lt;target name=&quot;integration-test&quot;&gt;
        &lt;varnishtest:run&gt;
            &lt;fileset dir=&quot;src/test/varnish&quot;&gt;
                &lt;include name=&quot;**.vtc&quot;/&gt;
            &lt;/fileset&gt;
        &lt;/varnishtest:run&gt;
    &lt;/target&gt;
&lt;/project&gt;</pre></div></div><div class="section"><h2>Parameters<a name="Parameters"></a></h2><!-- copy/paste/rearrange from the javadocs --><table border="0" class="table table-striped"><tr class="a"><td align="left">Attribute</td><td align="left">Description</td><td align="left">Required</td></tr><tr class="b"><td align="left">reportsDirectory</td><td align="left">Set the directory where the reports will be written.</td><td align="left">No.</td></tr><tr class="a"><td align="left">timeout</td><td align="left">Set the per-test timeout in seconds.</td><td align="left">No, defaults to 20 seconds.</td></tr><tr class="b"><td align="left">varnishdCommand</td><td align="left">Set a different command for <tt>varnishd</tt>, for instance <tt>/usr/sbin/varnishd</tt> for unprivileged users without <tt>/usr/sbin</tt> in their <tt>PATH</tt>.</td><td align="left">No, defaults to <tt>varnishd</tt>.</td></tr><tr class="a"><td align="left">varnishtestCommand</td><td align="left">Set a different command for <tt>varnishtest</tt>, for instance <tt>/usr/local/bin/varnishtest</tt>.</td><td align="left">No, defaults to <tt>varnishtest</tt>.</td></tr><tr class="b"><td align="left">workingDirectory</td><td align="left">Set the directory in which varnishtest will be executed. <b>Since: 0.2</b></td><td align="left">No, defaults to the base directory.</td></tr></table></div><div class="section"><h2>Nested Elements<a name="Nested_Elements"></a></h2><p>The <tt>&lt;varnishtest:run&gt;</tt> task supports a nested <tt>&lt;macro&gt;</tt> element to pass arguments to <tt>varnishtest</tt>. It also collects the test files from any number of nested file-only <a class="externalLink" href="http://ant.apache.org/manual/Types/resources.html#collection">Resource Collections</a>.</p><div class="section"><h3>macro<a name="macro"></a></h3><p>It is possible to pass macros to <tt>varnishtest</tt> with a <tt>-Dname=value</tt> argument in the command line. In your test case, any occurrence of <tt>${name}</tt> will be substitued by <tt>value</tt>. Some macros are reserved and defined by <tt>varnishtest</tt>:</p><ul><li><b>bad_ip:</b> A bad IP address useful to test backend failures.</li><li><b>pwd:</b> The test case working directory.</li><li><b>tmpdir:</b> The test case temporary directory.</li><li><b>varnishd:</b> This one is actually defined by <tt>varnishtest-exec</tt>.</li></ul><!-- copy/paste/rearrange from the javadocs --><table border="0" class="table table-striped"><tr class="a"><td align="left">Attribute</td><td align="left">Description</td><td align="left">Required</td></tr><tr class="b"><td align="left">name</td><td align="left">Sets the name of the macro. The name should be unique or else this macro will be overridden.</td><td align="left">Yes.</td></tr><tr class="a"><td align="left">value</td><td align="left">Set the per-test timeout in seconds.</td><td align="left">Yes.</td></tr></table><div class="section"><h4>Example<a name="Example"></a></h4><div class="source"><pre class="prettyprint">&lt;varnishtest:run&gt;
  &lt;file file=&quot;src/test/varnish/test.vtc&quot;/&gt;
  &lt;macros&gt;
    &lt;macro name=&quot;backend_port&quot; value=&quot;8080&quot;/&gt;
  &lt;/macros&gt;
&lt;/varnishtest:run&gt;</pre></div></div></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                   2012-2013.
          All Rights Reserved.      
            
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
